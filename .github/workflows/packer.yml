---

name: Packer

on:
  push:

jobs:
  packer:
    runs-on: ubuntu-16.04 
    name: packer

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2
      - name: Install QEMU and run Packer 
        run: sudo apt update && sudo apt install qemu qemu-system -y && PACKER_LOG=1 packer build flatcar/flatcar-linux.json 
      - name: bla
        run: tree
      - name: Compress txt with gzip
        uses: coco-hkk/compress-action@v2.1
        id: step1
        with:
          file-suffix: 'qcow2'
          target-directory-path: 'output'
          compress-tool: 'gzip'
      - name:  bla
        run: tree
      - name: Create release
        uses: Roang-zero1/github-create-release-action@master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          #      - name: Create GitHub release
          #        uses: Roang-zero1/github-upload-release-artifacts-action@master
          #        with:
          #          args:
          #          - output/
